name: Restore Kelee Directory

on:
  workflow_dispatch:

jobs:
  restore:
    runs-on: ubuntu-latest

    steps:
      - name: Clone full repo history
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # 获取完整提交历史

      - name: Create restore branch
        run: |
          git checkout -b restore-temp

      - name: Checkout old commit with the deleted directory
        run: |
          git checkout d28b1d09f335d5513a2aac5beb78007ca13e47c4
          mkdir -p temp_restore
          cp -r Modules/Loon/Kelee temp_restore/

      - name: Switch back to main branch
        run: |
          git checkout -
          cp -r temp_restore/Kelee Modules/Loon/

      - name: Commit and push restored folder
        run: |
          git config --global user.name "${GITHUB_ACTOR}"
          git config --global user.email "${GITHUB_ACTOR}@users.noreply.github.com"
          git add Modules/Loon/Kelee
          git commit -m "Restore deleted directory Modules/Loon/Kelee"
          git push
